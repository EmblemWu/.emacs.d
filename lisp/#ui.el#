;; File: ui.el

(global-display-line-numbers-mode)
(menu-bar-mode -1)
(tool-bar-mode -1)
(scroll-bar-mode -1)

(setq initial-buffer-choice t)  

(setq mode-line-format
      (list
       '(:eval (list (nyan-create)))))

;; ---------------------------
;; Fonts
;; ---------------------------
;; Set default and variable-pitch fonts. Height is 1/10 pt (170 = 17pt).
(set-face-attribute 'default nil :family "Roboto mono" :height 170 :weight 'medium)
(set-face-attribute 'variable-pitch nil :family "Fira Sans" :height 190 :weight 'bold)

;; Optional serif/fixed-pitch-serif mapping:
(when (facep 'fixed-pitch-serif)
  (set-face-attribute 'fixed-pitch-serif nil :family "Fira Code" :height 210 :weight 'regular))

;; 中文字体映射，避免中英文混排时 fallback 不一致（按需调整）
;; 优先使用苹方；如果没有则尝试 Noto Sans CJK / 思源黑体
(let ((cn-font (or (car (seq-filter (lambda (f) (member f (font-family-list)))
                                    '("PingFang SC" "Noto Sans CJK SC" "Source Han Sans SC" "Hiragino Sans GB")))
                   nil)))
  (when cn-font
    (set-fontset-font t 'han (font-spec :family cn-font :size 16))
    (set-fontset-font t 'kana (font-spec :family cn-font :size 16))
    (set-fontset-font t 'cjk-misc (font-spec :family cn-font :size 16))))

;; 等宽中文（如代码块里汉字对齐）可选：
(when (member "PingFang SC" (font-family-list))
  ;; 将固定宽度中文映射到苹方，防止等宽字符错位
  (set-fontset-font "fontset-default" 'han (font-spec :family "PingFang SC" :size 16)))

;; ---------------------------
;; Themes
;; ---------------------------
;; auto-dark 配置（包在 packages.el 中声明）
;; 默认不启用，且防止它在启动时抢主题；若需自动切换，请手动 M-x auto-dark-mode

(with-eval-after-load 'auto-dark
  ;; 日/夜都用 alabaster，避免切换时被深色主题覆盖；需要深色可自行改第一个列表。
  (setq auto-dark-themes '((alabaster-dark) (alabaster))
        auto-dark-polling-interval-seconds 5
        auto-dark-allow-osascript nil
        auto-dark-allow-powershell nil))

;; macOS 图形细节：移除装饰 + 最大化（适合 everywhere 浮窗）
;; 如需系统原生全屏，把 fullscreen 改为 'fullboth 并保留 (undecorated . nil)
(setq default-frame-alist
      '((undecorated . t)
        (fullscreen . maximized)
;;        (ns-appearance . light)  ;; 按你系统主题改为 'dark 或 'light
        (ns-transparent-titlebar . t)))

(provide 'ui)
